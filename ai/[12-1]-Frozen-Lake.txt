4:"$Sreact.fragment"
5:I[4839,["839","static/chunks/839-ee0b8cfd2b2dd0ab.js","271","static/chunks/app/%5Btheme%5D/%5Bpost%5D/page-96b2f175d909b16b.js"],""]
6:I[2404,["87","static/chunks/0e762574-45ffabdaeed21b00.js","839","static/chunks/839-ee0b8cfd2b2dd0ab.js","177","static/chunks/app/layout-99a62564e3117795.js"],"DarkModeButton"]
7:I[5244,[],""]
8:I[3866,[],""]
b:I[6213,[],"OutletBoundary"]
d:I[6213,[],"MetadataBoundary"]
f:I[6213,[],"ViewportBoundary"]
11:I[4835,[],""]
1:HL["/_next/static/media/7626ed2c039b2726-s.p.woff2","font",{"crossOrigin":"","type":"font/woff2"}]
2:HL["/_next/static/media/a34f9d1faa5f3315-s.p.woff2","font",{"crossOrigin":"","type":"font/woff2"}]
3:HL["/_next/static/css/a18af851ce58a3b2.css","style"]
0:{"P":null,"b":"JuDz9gXrWSrJrH-VpEr8R","p":"","c":["","ai","%5B12-1%5D-Frozen-Lake"],"i":false,"f":[[["",{"children":[["theme","ai","d"],{"children":[["post","%5B12-1%5D-Frozen-Lake","d"],{"children":["__PAGE__",{}]}]}]},"$undefined","$undefined",true],["",["$","$4","c",{"children":[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/a18af851ce58a3b2.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}]],["$","html",null,{"lang":"ko","children":["$","body",null,{"className":"__className_9b822d\n                min-h-screen\n                bg-slate-50 text-slate-900 dark:bg-slate-900 dark:text-slate-50","children":["$","div",null,{"className":"grid grid-cols-[24rem_1fr] auto-rows-auto","children":[["$","nav",null,{"className":"\n        __className_92d895\n        z-20\n        text-xl h-12 md:h-14 md:text-2xl\n        bg-slate-50/30 dark:bg-slate-900/30 border-b-slate-300 dark:border-b-slate-600\n        backdrop-blur-md\n        w-full\n        flex\n        items-center\n        justify-between\n        pl-5\n        pr-5\n        mb-20\n        border-b-2\n        border-b-slate-300\n        fixed","children":[["$","$L5",null,{"href":"/","children":"tomatoM4to's blog"}],["$","div",null,{"className":"hidden lg:flex items-center","children":[["$","input",null,{"type":"text","className":"w-36 h-7 rounded-full border-2 border-black pl-2","placeholder":"search"}],["$","div",null,{"className":"bg-slate-300 h-10 w-0.5 ml-2"}],["$","$L5",null,{"href":"https://github.com/tomatoM4to/tomatoM4to.github.io","className":"p-2 rounded-full hover:bg-slate-300 dark:hover:bg-slate-600 transition-colors duration-300","children":["$","svg",null,{"stroke":"currentColor","fill":"currentColor","strokeWidth":"0","viewBox":"0 0 16 16","className":"text-2xl cursor-pointer","children":["$undefined",[["$","path","0",{"fillRule":"evenodd","clipRule":"evenodd","d":"M7.976 0A7.977 7.977 0 0 0 0 7.976c0 3.522 2.3 6.507 5.431 7.584.392.049.538-.196.538-.392v-1.37c-2.201.49-2.69-1.076-2.69-1.076-.343-.93-.881-1.175-.881-1.175-.734-.489.048-.489.048-.489.783.049 1.224.832 1.224.832.734 1.223 1.859.88 2.3.685.048-.538.293-.88.489-1.076-1.762-.196-3.621-.881-3.621-3.964 0-.88.293-1.566.832-2.153-.05-.147-.343-.978.098-2.055 0 0 .685-.196 2.201.832.636-.196 1.322-.245 2.007-.245s1.37.098 2.006.245c1.517-1.027 2.202-.832 2.202-.832.44 1.077.146 1.908.097 2.104a3.16 3.16 0 0 1 .832 2.153c0 3.083-1.86 3.719-3.62 3.915.293.244.538.733.538 1.467v2.202c0 .196.146.44.538.392A7.984 7.984 0 0 0 16 7.976C15.951 3.572 12.38 0 7.976 0z","children":[]}]]],"style":{"color":"$undefined"},"height":"1em","width":"1em","xmlns":"http://www.w3.org/2000/svg"}]}],["$","button",null,{"className":"p-2 rounded-full hover:bg-slate-300 dark:hover:bg-slate-600 transition-colors duration-300","children":["$","svg",null,{"stroke":"currentColor","fill":"currentColor","strokeWidth":"0","viewBox":"0 0 24 24","className":"text-2xl cursor-pointer","children":["$undefined",[["$","path","0",{"fill":"none","strokeWidth":"2","d":"M12,23 C18.0751322,23 23,18.0751322 23,12 C23,5.92486775 18.0751322,1 12,1 C5.92486775,1 1,5.92486775 1,12 C1,18.0751322 5.92486775,23 12,23 Z M12,23 C15,23 16,18 16,12 C16,6 15,1 12,1 C9,1 8,6 8,12 C8,18 9,23 12,23 Z M2,16 L22,16 M2,8 L22,8","children":[]}]]],"style":{"color":"$undefined"},"height":"1em","width":"1em","xmlns":"http://www.w3.org/2000/svg"}]}],["$","$L6",null,{}]]}]]}],["$","main",null,{"className":"col-span-2","children":["$","$L7",null,{"parallelRouterKey":"children","segmentPath":["children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L8",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":[["$","title",null,{"children":"404: This page could not be found."}],["$","div",null,{"style":{"fontFamily":"system-ui,\"Segoe UI\",Roboto,Helvetica,Arial,sans-serif,\"Apple Color Emoji\",\"Segoe UI Emoji\"","height":"100vh","textAlign":"center","display":"flex","flexDirection":"column","alignItems":"center","justifyContent":"center"},"children":["$","div",null,{"children":[["$","style",null,{"dangerouslySetInnerHTML":{"__html":"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}"}}],["$","h1",null,{"className":"next-error-h1","style":{"display":"inline-block","margin":"0 20px 0 0","padding":"0 23px 0 0","fontSize":24,"fontWeight":500,"verticalAlign":"top","lineHeight":"49px"},"children":"404"}],["$","div",null,{"style":{"display":"inline-block"},"children":["$","h2",null,{"style":{"fontSize":14,"fontWeight":400,"lineHeight":"49px","margin":0},"children":"This page could not be found."}]}]]}]}]],"notFoundStyles":[]}]}]]}]}]}]]}],{"children":[["theme","ai","d"],["$","$4","c",{"children":[null,"$L9"]}],{"children":[["post","%5B12-1%5D-Frozen-Lake","d"],["$","$4","c",{"children":[null,["$","$L7",null,{"parallelRouterKey":"children","segmentPath":["children","$0:f:0:1:2:children:0","children","$0:f:0:1:2:children:2:children:0","children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L8",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined"}]]}],{"children":["__PAGE__",["$","$4","c",{"children":["$La",null,["$","$Lb",null,{"children":"$Lc"}]]}],{},null]},null]},null]},null],["$","$4","h",{"children":[null,["$","$4","69IA57Tk0z8PrJfRefEgl",{"children":[["$","$Ld",null,{"children":"$Le"}],["$","$Lf",null,{"children":"$L10"}],["$","meta",null,{"name":"next-size-adjust"}]]}]]}]]],"m":"$undefined","G":["$11","$undefined"],"s":false,"S":true}
10:[["$","meta","0",{"name":"viewport","content":"width=device-width, initial-scale=1, maximum-scale=1, user-scalable=yes"}]]
e:[["$","meta","0",{"charSet":"utf-8"}],["$","title","1",{"children":"tomatom4to's Computer Science Blog"}],["$","meta","2",{"name":"description","content":"Comprehensive computer science knowledge covering OS, Database, AI, Networks, Linux, and Docker. Learn computer science concepts with clear explanations and practical examples."}],["$","meta","3",{"name":"author","content":"tomatom4to"}],["$","meta","4",{"name":"keywords","content":"Computer Science,Operating Systems,Database,AI,Network,Linux,Docker,Programming,Software Development"}],["$","meta","5",{"name":"creator","content":"tomatom4to"}],["$","meta","6",{"name":"robots","content":"index, follow"}],["$","meta","7",{"name":"googlebot","content":"index, follow, max-video-preview:-1, max-image-preview:large, max-snippet:-1"}],["$","link","8",{"rel":"canonical","href":"https://tomatom4to.github.io"}],["$","meta","9",{"name":"format-detection","content":"telephone=no, address=no, email=no"}],["$","meta","10",{"property":"og:title","content":"tomatom4to's Computer Science Blog"}],["$","meta","11",{"property":"og:description","content":"Your gateway to comprehensive computer science knowledge and practical programming skills"}],["$","meta","12",{"property":"og:url","content":"https://tomatom4to.github.io"}],["$","meta","13",{"property":"og:site_name","content":"tomatom4to's CS Blog"}],["$","meta","14",{"property":"og:locale","content":"ko_KR"}],["$","meta","15",{"property":"og:type","content":"website"}],["$","meta","16",{"name":"twitter:card","content":"summary"}],["$","meta","17",{"name":"twitter:title","content":"tomatom4to's Computer Science Blog"}],["$","meta","18",{"name":"twitter:description","content":"Your gateway to comprehensive computer science knowledge and practical programming skills"}],["$","link","19",{"rel":"icon","href":"/icon.png?09be0199f64930e1","type":"image/png","sizes":"500x500"}]]
c:null
12:I[9051,["87","static/chunks/0e762574-45ffabdaeed21b00.js","949","static/chunks/578c2090-175257547869ead6.js","206","static/chunks/5e22fd23-a3f66ab797e86fa4.js","585","static/chunks/b563f954-2e58cc71e37cba32.js","711","static/chunks/8e1d74a4-98d5a7d540bb92c7.js","839","static/chunks/839-ee0b8cfd2b2dd0ab.js","859","static/chunks/app/%5Btheme%5D/layout-0c0e2feef1c385d9.js"],"Hamburger"]
13:I[4783,["87","static/chunks/0e762574-45ffabdaeed21b00.js","949","static/chunks/578c2090-175257547869ead6.js","206","static/chunks/5e22fd23-a3f66ab797e86fa4.js","585","static/chunks/b563f954-2e58cc71e37cba32.js","711","static/chunks/8e1d74a4-98d5a7d540bb92c7.js","839","static/chunks/839-ee0b8cfd2b2dd0ab.js","859","static/chunks/app/%5Btheme%5D/layout-0c0e2feef1c385d9.js"],"NonAccordionLink"]
14:I[4783,["87","static/chunks/0e762574-45ffabdaeed21b00.js","949","static/chunks/578c2090-175257547869ead6.js","206","static/chunks/5e22fd23-a3f66ab797e86fa4.js","585","static/chunks/b563f954-2e58cc71e37cba32.js","711","static/chunks/8e1d74a4-98d5a7d540bb92c7.js","839","static/chunks/839-ee0b8cfd2b2dd0ab.js","859","static/chunks/app/%5Btheme%5D/layout-0c0e2feef1c385d9.js"],"Accordion"]
15:I[4783,["87","static/chunks/0e762574-45ffabdaeed21b00.js","949","static/chunks/578c2090-175257547869ead6.js","206","static/chunks/5e22fd23-a3f66ab797e86fa4.js","585","static/chunks/b563f954-2e58cc71e37cba32.js","711","static/chunks/8e1d74a4-98d5a7d540bb92c7.js","839","static/chunks/839-ee0b8cfd2b2dd0ab.js","859","static/chunks/app/%5Btheme%5D/layout-0c0e2feef1c385d9.js"],"AccordionItem"]
9:["$","div",null,{"className":"flex","children":[["$","$L12",null,{"res":[{"title":"Introduction","originalName":"[1]-Introduction","order":1,"contentList":[]},{"title":"Basis math","originalName":"[2]-Basis-math","order":2,"contentList":[{"isTitle":false,"firstOrder":2,"secondOrder":1,"order":"2-1","title":"Math with RL","originalName":"[2-1]-Math-with-RL","index":3}]},{"title":"Q learning","originalName":"[3]-Q-learning","order":3,"contentList":[{"isTitle":false,"firstOrder":3,"secondOrder":1,"order":"3-1","title":"Basic Concept","originalName":"[3-1]-Basic-Concept","index":4},{"isTitle":false,"firstOrder":3,"secondOrder":2,"order":"3-2","title":"Greedy action","originalName":"[3-2]-Greedy-action","index":5},{"isTitle":false,"firstOrder":3,"secondOrder":3,"order":"3-3","title":"Discount factor","originalName":"[3-3]-Discount-factor","index":6},{"isTitle":false,"firstOrder":3,"secondOrder":4,"order":"3-4","title":"Learning rate","originalName":"[3-4]-Learning-rate","index":7}]},{"title":"Markov process","originalName":"[4]-Markov-process","order":4,"contentList":[]},{"title":"Bellman Optimality Equation","originalName":"[5]-Bellman-Optimality-Equation","order":5,"contentList":[]},{"title":"DP","originalName":"[6]-DP","order":6,"contentList":[]},{"title":"Monte Carlo","originalName":"[7]-Monte-Carlo","order":7,"contentList":[]},{"title":"Temporal Difference Learning","originalName":"[8]-Temporal-Difference-Learning","order":8,"contentList":[]},{"title":"nSTEP Bootstrapping","originalName":"[9]-nSTEP-Bootstrapping","order":9,"contentList":[]},{"title":"Planning and Learning","originalName":"[10]-Planning-and-Learning","order":10,"contentList":[{"isTitle":false,"firstOrder":10,"secondOrder":1,"order":"10-1","title":"Function Approximation","originalName":"[10-1]-Function-Approximation","index":14}]},{"title":"Deep learning","originalName":"[11]-Deep-learning","order":11,"contentList":[{"isTitle":false,"firstOrder":11,"secondOrder":1,"order":"11-1","title":"Concept","originalName":"[11-1]-Concept","index":16},{"isTitle":false,"firstOrder":11,"secondOrder":2,"order":"11-2","title":"Newerl Network","originalName":"[11-2]-Newerl-Network","index":17},{"isTitle":false,"firstOrder":11,"secondOrder":3,"order":"11-3","title":"Loss function","originalName":"[11-3]-Loss-function","index":18},{"isTitle":false,"firstOrder":11,"secondOrder":4,"order":"11-4","title":"Activation function","originalName":"[11-4]-Activation-function","index":19},{"isTitle":false,"firstOrder":11,"secondOrder":5,"order":"11-5","title":"Gradient descent","originalName":"[11-5]-Gradient-descent","index":20},{"isTitle":false,"firstOrder":11,"secondOrder":6,"order":"11-6","title":"Back Propagation","originalName":"[11-6]-Back-Propagation","index":21}]},{"title":"Q Network","originalName":"[12]-Q-Network","order":12,"contentList":[{"isTitle":false,"firstOrder":12,"secondOrder":1,"order":"12-1","title":"Frozen Lake","originalName":"[12-1]-Frozen-Lake","index":23},{"isTitle":false,"firstOrder":12,"secondOrder":2,"order":"12-2","title":"Cartpole","originalName":"[12-2]-Cartpole","index":24}]},{"title":"DQN","originalName":"[13]-DQN","order":13,"contentList":[{"isTitle":false,"firstOrder":13,"secondOrder":1,"order":"13-1","title":"Concept","originalName":"[13-1]-Concept","index":26},{"isTitle":false,"firstOrder":13,"secondOrder":2,"order":"13-2","title":"Cartpole","originalName":"[13-2]-Cartpole","index":27}]},{"title":"Policy gradient","originalName":"[14]-Policy-gradient","order":14,"contentList":[{"isTitle":false,"firstOrder":14,"secondOrder":1,"order":"14-1","title":"A3C","originalName":"[14-1]-A3C","index":29}]}],"params":{"theme":"ai"}}],["$","aside",null,{"className":"\n                hidden lg:flex w-64 2xl:w-96\n                border-r-slate-300 dark:border-r-slate-600\n                flex-col\n                h-screen\n                border-r-2\n                p-1\n                pl-5\n                pt-14\n                fixed\n                overflow-y-auto\n                overscroll-contain\n                z-auto\n                ","children":[["$","$L13","0",{"href":"./[1]-Introduction","label":"Introduction"}],["$","$L14","1",{"label":"Basis math","children":["$","$L15",null,{"contentList":"$9:props:children:0:props:res:1:contentList"}]}],["$","$L14","2",{"label":"Q learning","children":["$","$L15",null,{"contentList":"$9:props:children:0:props:res:2:contentList"}]}],["$","$L13","3",{"href":"./[4]-Markov-process","label":"Markov process"}],["$","$L13","4",{"href":"./[5]-Bellman-Optimality-Equation","label":"Bellman Optimality Equation"}],["$","$L13","5",{"href":"./[6]-DP","label":"DP"}],["$","$L13","6",{"href":"./[7]-Monte-Carlo","label":"Monte Carlo"}],["$","$L13","7",{"href":"./[8]-Temporal-Difference-Learning","label":"Temporal Difference Learning"}],["$","$L13","8",{"href":"./[9]-nSTEP-Bootstrapping","label":"nSTEP Bootstrapping"}],["$","$L14","9",{"label":"Planning and Learning","children":["$","$L15",null,{"contentList":"$9:props:children:0:props:res:9:contentList"}]}],["$","$L14","10",{"label":"Deep learning","children":["$","$L15",null,{"contentList":"$9:props:children:0:props:res:10:contentList"}]}],["$","$L14","11",{"label":"Q Network","children":["$","$L15",null,{"contentList":"$9:props:children:0:props:res:11:contentList"}]}],["$","$L14","12",{"label":"DQN","children":["$","$L15",null,{"contentList":"$9:props:children:0:props:res:12:contentList"}]}],["$","$L14","13",{"label":"Policy gradient","children":["$","$L15",null,{"contentList":"$9:props:children:0:props:res:13:contentList"}]}]]}],["$","$L7",null,{"parallelRouterKey":"children","segmentPath":["children","$0:f:0:1:2:children:0","children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L8",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined"}]]}]
a:["$","div",null,{"className":"lg:ml-64 2xl:ml-96 mt-32 mb-32 flex-1 flex flex-col items-center overflow-x-hidden","children":[["$","div",null,{"className":"w-11/12 lg:w-2/3 2xl:w-1/2 markdown-body","children":[["$","p",null,{"children":["$","a",null,{"href":"https://dryjelly.tistory.com/138","children":"https://dryjelly.tistory.com/138"}]}],"\n",["$","h1",null,{"children":"소개","className":" text-3xl md:text-4xl font-extrabold my-6 text-transparent bg-clip-text bg-gradient-to-r from-blue-500 via-purple-500 to-pink-500"}],"\n",["$","p",null,{"children":"이전에 공부했던 Q-network를 Frozen Lake에 적용해 보겠습니다. 하지만 여러분들도 알다 싶이 Frozen Lake는 굉장히 쉬운 문제입니다. 이 문제를 해결하기 위해 NN을 적용한다는것은 마치 사과를 깎기 위해 팔뚝만한 중식도를 사용하는것과 같습니다. 그저 이해를 돕기 위한 코드란 점을 감안해 주세요."}],"\n",["$","p",null,{"children":"코드응 pytorch 를 사용합니다."}],"\n",["$","p",null,{"children":"전체 코드"}],"\n",["$","pre",null,{"children":["$","code",null,{"className":"overflow-x-auto bg-slate-300 border border-slate-400 dark:bg-slate-600 dark:border-slate-500 px-1 rounded-md hljs language-python","children":[["$","span",null,{"className":"hljs-keyword","children":"import"}]," gymnasium ",["$","span",null,{"className":"hljs-keyword","children":"as"}]," gym\n",["$","span",null,{"className":"hljs-keyword","children":"import"}]," numpy ",["$","span",null,{"className":"hljs-keyword","children":"as"}]," np\n",["$","span",null,{"className":"hljs-keyword","children":"import"}]," torch\n",["$","span",null,{"className":"hljs-keyword","children":"import"}]," torch.nn ",["$","span",null,{"className":"hljs-keyword","children":"as"}]," nn\n",["$","span",null,{"className":"hljs-keyword","children":"import"}]," torch.optim ",["$","span",null,{"className":"hljs-keyword","children":"as"}]," optim\n",["$","span",null,{"className":"hljs-keyword","children":"import"}]," matplotlib.pyplot ",["$","span",null,{"className":"hljs-keyword","children":"as"}]," plt\n\n",["$","span",null,{"className":"hljs-keyword","children":"class"}]," ",["$","span",null,{"className":"hljs-title class_","children":"QNetwork"}],"(nn.Module):\n    ",["$","span",null,{"className":"hljs-keyword","children":"def"}]," ",["$","span",null,{"className":"hljs-title function_","children":"__init__"}],"(",["$","span",null,{"className":"hljs-params","children":"self, input_size, output_size"}],"):\n        ",["$","span",null,{"className":"hljs-built_in","children":"super"}],"(QNetwork, ",["$","span",null,{"className":"hljs-variable language_","children":"self"}],").__init__()\n        ",["$","span",null,{"className":"hljs-variable language_","children":"self"}],".layer1 = nn.Linear(input_size, output_size)\n\n    ",["$","span",null,{"className":"hljs-keyword","children":"def"}]," ",["$","span",null,{"className":"hljs-title function_","children":"forward"}],"(",["$","span",null,{"className":"hljs-params","children":"self, x"}],"):\n        ",["$","span",null,{"className":"hljs-keyword","children":"return"}]," ",["$","span",null,{"className":"hljs-variable language_","children":"self"}],".layer1(x)\n\n",["$","span",null,{"className":"hljs-keyword","children":"class"}]," ",["$","span",null,{"className":"hljs-title class_","children":"DQNAgent"}],":\n    ",["$","span",null,{"className":"hljs-keyword","children":"def"}]," ",["$","span",null,{"className":"hljs-title function_","children":"__init__"}],"(",["$","span",null,{"className":"hljs-params","children":["self, input_size, output_size, learning_rate=",["$","span",null,{"className":"hljs-number","children":"0.1"}],", gamma=",["$","span",null,{"className":"hljs-number","children":"0.99"}]]}],"):\n        ",["$","span",null,{"className":"hljs-variable language_","children":"self"}],".device = torch.device(",["$","span",null,{"className":"hljs-string","children":"\"cuda\""}]," ",["$","span",null,{"className":"hljs-keyword","children":"if"}]," torch.cuda.is_available() ",["$","span",null,{"className":"hljs-keyword","children":"else"}]," ",["$","span",null,{"className":"hljs-string","children":"\"cpu\""}],")\n        ",["$","span",null,{"className":"hljs-variable language_","children":"self"}],".q_network = QNetwork(input_size, output_size).to(",["$","span",null,{"className":"hljs-variable language_","children":"self"}],".device)\n        ",["$","span",null,{"className":"hljs-variable language_","children":"self"}],".optimizer = optim.SGD(",["$","span",null,{"className":"hljs-variable language_","children":"self"}],".q_network.parameters(), lr=learning_rate)\n        ",["$","span",null,{"className":"hljs-variable language_","children":"self"}],".gamma = gamma\n\n    ",["$","span",null,{"className":"hljs-keyword","children":"def"}]," ",["$","span",null,{"className":"hljs-title function_","children":"get_action"}],"(",["$","span",null,{"className":"hljs-params","children":"self, state, epsilon"}],"):\n        ",["$","span",null,{"className":"hljs-keyword","children":"with"}]," torch.no_grad():\n            state_tensor = state.to(",["$","span",null,{"className":"hljs-variable language_","children":"self"}],".device)\n            q_values = ",["$","span",null,{"className":"hljs-variable language_","children":"self"}],".q_network(state_tensor.unsqueeze(",["$","span",null,{"className":"hljs-number","children":"0"}],"))  ",["$","span",null,{"className":"hljs-comment","children":"# Batch 추가"}],"\n            ",["$","span",null,{"className":"hljs-keyword","children":"if"}]," np.random.random() < epsilon:\n                ",["$","span",null,{"className":"hljs-keyword","children":"return"}]," np.random.randint(q_values.size(-",["$","span",null,{"className":"hljs-number","children":"1"}],"))\n            ",["$","span",null,{"className":"hljs-keyword","children":"return"}]," q_values.argmax().item()\n\n    ",["$","span",null,{"className":"hljs-keyword","children":"def"}]," ",["$","span",null,{"className":"hljs-title function_","children":"train_step"}],"(",["$","span",null,{"className":"hljs-params","children":"self, state, action, reward, next_state, done"}],"):\n        state_tensor = state.to(",["$","span",null,{"className":"hljs-variable language_","children":"self"}],".device)\n        next_state_tensor = next_state.to(",["$","span",null,{"className":"hljs-variable language_","children":"self"}],".device)\n\n        ",["$","span",null,{"className":"hljs-comment","children":"# 현재 Q 값 계산"}],"\n        current_q_values = ",["$","span",null,{"className":"hljs-variable language_","children":"self"}],".q_network(state_tensor.unsqueeze(",["$","span",null,{"className":"hljs-number","children":"0"}],"))  ",["$","span",null,{"className":"hljs-comment","children":"# Batch 추가"}],"\n        q_value = current_q_values[",["$","span",null,{"className":"hljs-number","children":"0"}],", action].unsqueeze(",["$","span",null,{"className":"hljs-number","children":"0"}],")  ",["$","span",null,{"className":"hljs-comment","children":"# 차원 추가"}],"\n\n        ",["$","span",null,{"className":"hljs-comment","children":"# 타겟 Q 값 계산"}],"\n        ",["$","span",null,{"className":"hljs-keyword","children":"with"}]," torch.no_grad():\n            next_q_values = ",["$","span",null,{"className":"hljs-variable language_","children":"self"}],".q_network(next_state_tensor.unsqueeze(",["$","span",null,{"className":"hljs-number","children":"0"}],"))  ",["$","span",null,{"className":"hljs-comment","children":"# Batch 추가"}],"\n            max_next_q = next_q_values.",["$","span",null,{"className":"hljs-built_in","children":"max"}],"(",["$","span",null,{"className":"hljs-number","children":"1"}],")[",["$","span",null,{"className":"hljs-number","children":"0"}],"]\n            target = torch.tensor([reward + (",["$","span",null,{"className":"hljs-number","children":"1"}]," - done) * ",["$","span",null,{"className":"hljs-variable language_","children":"self"}],".gamma * max_next_q], device=",["$","span",null,{"className":"hljs-variable language_","children":"self"}],". device)  ",["$","span",null,{"className":"hljs-comment","children":"# 크기 맞추기"}],"\n\n        ",["$","span",null,{"className":"hljs-comment","children":"# 손실 계산 및 최적화"}],"\n        ",["$","span",null,{"className":"hljs-variable language_","children":"self"}],".optimizer.zero_grad()\n        loss = nn.MSELoss()(q_value, target)\n        loss.backward()\n        ",["$","span",null,{"className":"hljs-variable language_","children":"self"}],".optimizer.step()\n\n        ",["$","span",null,{"className":"hljs-keyword","children":"return"}]," loss.item()\n\n",["$","span",null,{"className":"hljs-string","children":"'''\nConverts an state (int) to a tensor representation.\nFor example, the FrozenLake 4x4 map has 4x4=16 states numbered from 0 to 15.\nParameters: state=1, num_states=16\nReturn: tensor([0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.])\n'''"}],"\n",["$","span",null,{"className":"hljs-keyword","children":"def"}]," ",["$","span",null,{"className":"hljs-title function_","children":"one_hot"}],"(",["$","span",null,{"className":"hljs-params","children":["state: ",["$","span",null,{"className":"hljs-built_in","children":"int"}],", num_states: ",["$","span",null,{"className":"hljs-built_in","children":"int"}]]}],") -> torch.Tensor:\n    input_tensor = torch.zeros(num_states)\n    input_tensor[state] = ",["$","span",null,{"className":"hljs-number","children":"1"}],"\n    ",["$","span",null,{"className":"hljs-keyword","children":"return"}]," input_tensor\n\n",["$","span",null,{"className":"hljs-keyword","children":"def"}]," ",["$","span",null,{"className":"hljs-title function_","children":"train"}],"():\n    env = gym.make(",["$","span",null,{"className":"hljs-string","children":"'FrozenLake-v1'"}],", is_slippery=",["$","span",null,{"className":"hljs-literal","children":"False"}],")\n    input_size = env.observation_space.n\n    output_size = env.action_space.n\n    num_episodes = ",["$","span",null,{"className":"hljs-number","children":"500"}],"\n    ",["$","span",null,{"className":"hljs-built_in","children":"print"}],"(",["$","span",null,{"className":"hljs-string","children":["f\"input_size: ",["$","span",null,{"className":"hljs-subst","children":"{input_size}"}],", output_size: ",["$","span",null,{"className":"hljs-subst","children":"{output_size}"}],"\""]}],")\n    agent = DQNAgent(input_size, output_size)\n    rewards_history = []\n\n    ",["$","span",null,{"className":"hljs-keyword","children":"for"}]," episode ",["$","span",null,{"className":"hljs-keyword","children":"in"}]," ",["$","span",null,{"className":"hljs-built_in","children":"range"}],"(num_episodes):\n        state = env.reset()[",["$","span",null,{"className":"hljs-number","children":"0"}],"]\n        state = one_hot(state, input_size)\n\n        epsilon = ",["$","span",null,{"className":"hljs-number","children":"1.0"}]," / ((episode / ",["$","span",null,{"className":"hljs-number","children":"50"}],") + ",["$","span",null,{"className":"hljs-number","children":"10"}],")\n        episode_reward = ",["$","span",null,{"className":"hljs-number","children":"0"}],"\n        done = ",["$","span",null,{"className":"hljs-literal","children":"False"}],"\n\n        ",["$","span",null,{"className":"hljs-keyword","children":"while"}]," ",["$","span",null,{"className":"hljs-keyword","children":"not"}]," done:\n            action = agent.get_action(state, epsilon)\n            next_state, reward, done, _, _ = env.step(action)\n            next_state = one_hot(next_state, input_size)\n\n            loss = agent.train_step(state, action, reward, next_state, done)\n            episode_reward += reward\n            state = next_state\n\n        rewards_history.append(episode_reward)\n\n    ",["$","span",null,{"className":"hljs-keyword","children":"return"}]," rewards_history\n\n",["$","span",null,{"className":"hljs-keyword","children":"if"}]," __name__ == ",["$","span",null,{"className":"hljs-string","children":"\"__main__\""}],":\n    rewards_history = train()\n    success_rate = ",["$","span",null,{"className":"hljs-built_in","children":"sum"}],"(rewards_history) / ",["$","span",null,{"className":"hljs-built_in","children":"len"}],"(rewards_history) * ",["$","span",null,{"className":"hljs-number","children":"100"}],"\n    ",["$","span",null,{"className":"hljs-built_in","children":"print"}],"(",["$","span",null,{"className":"hljs-string","children":["f\"Success rate: ",["$","span",null,{"className":"hljs-subst","children":["{success_rate:",["$","span",null,{"className":"hljs-number","children":".2"}],"f}"]}],"%\""]}],")\n\n    plt.bar(",["$","span",null,{"className":"hljs-built_in","children":"range"}],"(",["$","span",null,{"className":"hljs-built_in","children":"len"}],"(rewards_history)), rewards_history, color=",["$","span",null,{"className":"hljs-string","children":"\"blue\""}],")\n    plt.xlabel(",["$","span",null,{"className":"hljs-string","children":"\"Episode\""}],")\n    plt.ylabel(",["$","span",null,{"className":"hljs-string","children":"\"Reward\""}],")\n    plt.title(",["$","span",null,{"className":"hljs-string","children":"\"Rewards per Episode\""}],")\n    plt.savefig(",["$","span",null,{"className":"hljs-string","children":"\"Q-network-FrozenLake.png\""}],")\n"]}]}],"\n",["$","p",null,{"children":[["$","strong",null,{"children":"OUTPUT"}],"\n",["$","img",null,{"src":"./img/Q-network-FrozenLake.png","alt":"Q-network FrozenLake"}]]}],"\n",["$","hr",null,{}],"\n",["$","p",null,{"children":"질문 리스트"}],"\n",["$","ol",null,{"children":["\n",["$","li",null,{"children":"원핫 인코딩의 장점?"}],"\n",["$","li",null,{"children":"FrozenLake는 2차원 평면에서 이루어지는 게임이지만 해당 코드는 플레이어만 1로 표현하게 되는데, 결과가 나쁘지 않다, 이는 고정된 맵이기 때문에 특정 지역에 가면 안된다는것을 선형레이어로만으로도 학습이 되기 때문인가?"}],"\n",["$","li",null,{"children":"콘볼루션 레이어는 2차원 데이터를 파악하기 쉬운 레이어라고 알고 있는데, 이때 input에 해당하는 데이터는 굳이 RGB, 흑백 이미지 데이터가 아니라 임의적으로 선언한 1부터 N까지 숫자를 매핑해줘도 될까?"}],"\n",["$","li",null,{"children":"만약 된다면 1부터 N까지의 정수가 아닌 0.0부터 1.0까지의 숫자로 매핑해주는게 더 좋다는데 맞나?"}],"\n",["$","li",null,{"children":"2번 과제에서 멀티프레임을 적용시켰는데, 이를 사용한 근거는 단일 프레임으론 Agent의 움직임을 파악하기 힘들거 같아서 2프레림의 데이터를 중첩시켜서 사용했다, Atari 게임 논문에서도 4Frame의 데이터를 사용했는데 이는 Agent과 환경의 움직임을 파악하기 위함이라 해석했는데 그냥 단일 프레임으로 하면 시간이 너무 오래걸려선가?"}],"\n",["$","li",null,{"children":"카트폴 문제에선 환경에 대한 정보 없이 오로지 Agent의 데이터로만 학습을 진행했다(각도, 속도). 이는  외부 환경이 변하지 않기 때문이라 그런거 같은데, 환경이 변화하는 게임에서도 이러한 방식으로 학습을 진행할 수 있을까? 예를들어 꿀벌들의 위치, 말벌들의 위치, 내 위치, 내 방향 등등을 콘볼루션이 아닌 선형 레이어에 넣어서 학습을 진행한다면?"}],"\n",["$","li",null,{"children":"보상을 과도하게 준다면 학습이 빠르게 진행되지만 안정성이 떨어지고, 너무 적게준다면 학습이 느리게 진행되고, 너무 복잡하게 줘도 학습이 안될수도 있고.. 최대한 심플하게 줘야 하는건가?"}],"\n",["$","li",null,{"children":["보상이 너무 커서 불안정해 지는걸 막기 위해 ",["$","code",null,{"children":"torch.nn.utils.clip_grad_norm_(self.policy_net.parameters(), 1.0) # 클리핑","className":"overflow-x-auto bg-slate-300 border border-slate-400 dark:bg-slate-600 dark:border-slate-500 px-1 rounded-md "}]," 이런식으로 클리핑 시켰는데 이러면 이제 안정성을 확보하면서 학습을 빠르게 징행할수 있을까?"]}],"\n"],"className":"list-decimal ml-12 space-y-2 my-3"}]]}],["$","div",null,{"className":"flex justify-between items-center w-full mt-8 pt-4 gap-4 border-t-slate-600 border-t-2","children":[["$","$L5",null,{"href":"./[12]-Q-Network","className":"flex gap-2 justify-center items-center text-lg font-medium mx-5 py-4 rounded-lg basis-1/2 hover:bg-slate-700","children":[["$","svg",null,{"stroke":"currentColor","fill":"currentColor","strokeWidth":"0","viewBox":"0 0 448 512","children":["$undefined",[["$","path","0",{"d":"M257.5 445.1l-22.2 22.2c-9.4 9.4-24.6 9.4-33.9 0L7 273c-9.4-9.4-9.4-24.6 0-33.9L201.4 44.7c9.4-9.4 24.6-9.4 33.9 0l22.2 22.2c9.5 9.5 9.3 25-.4 34.3L136.6 216H424c13.3 0 24 10.7 24 24v32c0 13.3-10.7 24-24 24H136.6l120.5 114.8c9.8 9.3 10 24.8.4 34.3z","children":[]}]]],"className":"$undefined","style":{"color":"$undefined"},"height":"1em","width":"1em","xmlns":"http://www.w3.org/2000/svg"}]," ","Q Network"]}],["$","$L5",null,{"href":"./[12-2]-Cartpole","className":"flex gap-2 justify-center items-center text-lg font-medium py-4 rounded-lg basis-1/2 hover:bg-slate-700","children":["Cartpole"," ",["$","svg",null,{"stroke":"currentColor","fill":"currentColor","strokeWidth":"0","viewBox":"0 0 448 512","children":["$undefined",[["$","path","0",{"d":"M190.5 66.9l22.2-22.2c9.4-9.4 24.6-9.4 33.9 0L441 239c9.4 9.4 9.4 24.6 0 33.9L246.6 467.3c-9.4 9.4-24.6 9.4-33.9 0l-22.2-22.2c-9.5-9.5-9.3-25 .4-34.3L311.4 296H24c-13.3 0-24-10.7-24-24v-32c0-13.3 10.7-24 24-24h287.4L190.9 101.2c-9.8-9.3-10-24.8-.4-34.3z","children":[]}]]],"className":"$undefined","style":{"color":"$undefined"},"height":"1em","width":"1em","xmlns":"http://www.w3.org/2000/svg"}]]}]]}]]}]

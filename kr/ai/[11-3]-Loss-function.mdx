이전시간에 hidden layer를 도입하면 좀더 정교한 예측을 할수 있다 했습니다. 이번시간에는 이 hidden layer를 어떻게 학습시킬지 알아보겠습니다.

일단 node와 layer에 대해 집고 넘어가보겠습니다. 동그란건 노드고여 이 노드들이 모여서 layer를 구성하게 됩니다. node는 정확히 무엇일까요? 그냥 숫자라 생각해도 무관합니다.

이 숫자를 어떻게 지정할까요? 방법이 있지만 이전에 봤던 퍼셉트론 게산 방식과 똑같이 수행하시면 됩니다. 한 노드의 숫자를 지정하는법인 해당 노드와 연결된 이전 노드들을 전부 더하면 됩니다. 그냥 더하는건 아니가 각 weight를 곱해서 더해야 겠지만요. 이렇게 나온 결과를 $h1$, $h2$ 표현합니다 hidden layer 1 이란 뜻입니다.


이전에서도 말했지만 해당 w를 어떻게 찾을까요? 모르는 상태에선 랜덤한 값으로 지정하고, 이후에 학습을 통해 최적의 w를 찾아가는겁니다. 그리고 오차를 최소화 하는 w값들을 찾으라는 거죠, 그렇다면 이 계산 방식도 필요할것 같습니다.

이땐 실제 데이터를 가져와서 오차를 계산해야겠죠? 한번 해보겠습니다.

| 이름 | 6월 | 9월 | 수능 |
|------|-----|-----|-----|
| A    | 70  | 80  | 85  |
| B    | 80  | 90  | 95  |
| C    | 90  | 100 | 105 |

모 이전에도 단순하게 계산해봤지만 이번엔 실제 사용하는 방법으로 해보겠습니다. 이때 사용하는것이 평균 제곱 오차로 구해보겠습니다.

TODO: 계산 해야함

이런식으로 오차를 계산하는 함수를 **Loss function** or **cost function** 이라 합니다.

```math
\text{Loss function} = \frac{1}{n} \sum_{i=1}^{n} (\hat{y_i} - y_i)^2
```

이때 $\hat{y_i}$ 처럼 머리 위에 화살표 난 애들은 예측값을 뜻합니다. $y_i$는 실제 수능 성적이라 생각하시면 됩니다.

TODO: 평균 제곱 오차나 믿에 있는 설명이나 똑같은거임

보통 정수를 예측할때 저 함수를 사용하고요 하지만 확률을 예측할때는 이러한 함수를 사용합니다.

```math
-\frac{1}{n}\sum[y\log(\hat{y}) + (1-y)\log(1-\hat{y})]
```

배운것

* hidden layer가 있을 때 예측 결과 계산하는법
* 내 모델이 정확한지 오차 계산하는 법(Loss function)

***

# Linear Regression
기본적인 딥러닝에 대해 소개했습니다. 이젠 기본적인 선형 회귀에 대해 알아보겠습니다. 선형 회귀는 가장 기본적인 머신러닝 알고리즘 중 하나입니다. 선형 회귀는 데이터의 경향성을 가장 잘 설명하는 하나의 직선을 찾는 알고리즘입니다.

먼저 이러한 데이터가 있다 가정해 보겠습니다.
| x(hours) | y(score) |
|----------|----------|
| 10       | 90       |
| 9        | 80       |
| 3        | 50       |
| 2        | 30       |

이 데이터는 x 시간 공부를 했을 때 y 점수를 얻었다는 데이터입니다. 이 데이터를 이용하여 Super vised learning을 한다 가정해 보겠습니다. 결과적으로 0 ~ 100 까지의 점수를 예측하는것이 목표이고 이러한 형태의 ML을 Super vised learning 중에서도 Regression이라고 합니다.

이러한 트레이닝 데이터를 가지고 train을 수행하면 regression 모델이 만들어 집니다. 쉽게 말해 그냥 Agent를 만든다고 생각하시면 됩니다. 그리고 이후 7시간이라는 IN을 던지면 regression은 학습된 데이터를 기반으로 적절한 OUT을 내놓습니다.

이러한 방식을 Linear Regression 이라고 합니다.

설명을 간단히 하기 위해 테이블을 더 간단히 하겠습니다. 이 모델을 가지고 regression 모델을 만들려고 하는 겁니다.

| x | y |
|---|---|
| 1 | 1 |
| 2 | 2 |
| 3 | 3 |

이러한 데이터를 그래프로 표현해보면 다음과 같습니다.